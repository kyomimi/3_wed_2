<!DOCTYPE html>
<html>
<head>
  <title>トランプカード選択アプリ</title>
  <style>
    .card-button {
      padding: 5px;
      margin: 5px;
    }
  </style>
</head>
<body>
  <h1>トランプカード選択アプリ</h1>

  <div id="card-selection">
    <h2>カードを選択してください</h2>
    <div id="card-buttons"></div>
  </div>

  <div id="result">
    <h2 id="result-label">選択中のカード:</h2>
    <button id="save-button">CSVに保存</button>
  </div>

  <script>
    // カードボタンの作成
    var selectedCards = [];

    function selectCard(card) {
      var index = selectedCards.indexOf(card);
      if (index === -1) {
        if (selectedCards.length < 5) {
          selectedCards.push(card);
          updateResultLabel();
        } else {
          setResultLabelText("最大5枚まで選択できます。");
        }
      } else {
        selectedCards.splice(index, 1);
        updateResultLabel();
      }
    }

    function updateResultLabel() {
      var resultLabel = document.getElementById("result-label");
      resultLabel.textContent = "選択中のカード: " + selectedCards.join(", ");
    }

    function setResultLabelText(text) {
      var resultLabel = document.getElementById("result-label");
      resultLabel.textContent = text;
    }

    var cardButtonsContainer = document.getElementById("card-buttons");
    var suits = ["♠", "♥", "♦", "♣"];
    var numbers = ["A", "2", "3", "4", "5", "6", "7", "8", "9", "10", "J", "Q", "K"];

    for (var i = 0; i < suits.length; i++) {
      for (var j = 0; j < numbers.length; j++) {
        var suit = suits[i];
        var number = numbers[j];
        var card = suit + number;
        var button = document.createElement("button");
        button.textContent = card;
        button.classList.add("card-button");
        button.addEventListener("click", function () {
          selectCard(this.textContent);
        });
        cardButtonsContainer.appendChild(button);
      }
    }

    // CSV保存ボタンの作成
    var saveButton = document.getElementById("save-button");
    saveButton.addEventListener("click", function () {
      saveToCSV();
    });

    function saveToCSV() {
      if (selectedCards.length > 0) {
        var csvContent = "選択したカード\n" + selectedCards.join("\n");
        var encodedUri = encodeURI("data:text/csv;charset=utf-8," + csvContent);
        var link = document.createElement("a");
        link.setAttribute("href", encodedUri);
        link.setAttribute("download", "card_selection.csv");
        document.body.appendChild(link);
        link.click();
        setResultLabelText("CSVファイルに保存しました。");
      } else {
        setResultLabelText("選択したカードがありません。");
      }
    }
  </script>
</body>
</html>
